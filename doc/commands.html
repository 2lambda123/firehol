<HTML>
<HEAD>
<link rel="stylesheet" type="text/css" href="css.css">
<TITLE>FireHOL, command reference</TITLE>
</HEAD>

<BODY bgcolor="#FFFFFF">

<center><a name="contents"><h2>Table of Contents</h2></a></center>
<ul>
	<li><a href="#primary_commands">Primary Commands</a>
		<ul>
			<li><a href="#interface">interface</a>, control what the firewall host can do
			<li><a href="#router">router</a>, control what traffic can pass through the firewall host
			<li><a href="#version">version</a>, require a specific version of FireHOL
			<li><a href="#iptables">iptables</a>, add some custom iptables commands to the firewall
		</ul>
		&nbsp;
	</li>
	<li><a href="#subcommands">Sub-Commands</a>
		<ul>
			<li><a href="#policy">policy</a>, set the default action for unmatched packets of an
				<a href="#interface">interface</a>
			</li>
			<li><a href="#protection">protection</a>, add extra protections to
				<a href="#interface">interfaces</a> and <a href="#router">routers</a>
			</li>
			<li><a href="#server">server</a>, accept requests to some <a href="services.html">service</a>
			</li>
			<li><a href="#client">client</a>, accept replies to some <a href="services.html">service</a>
			</li>
			<li><a href="#route">route</a>, route traffic
			</li>
			<li><a href="#masquerade">masquerade</a>, setup masquerading to an
				<a href="#interface">interface</a>
			</li>
		</ul>
		&nbsp;
	</li>
	<li><a href="#parameters">Optional Rule Parameters</a>
		<ul>
			<li><a href="#src">src</a>, set the source of traffic</li>
			<li><a href="#dst">dst</a>, set the destination of traffic</li>
			<li><a href="#inface">inface</a>, set the network interface traffic is received via</li>
			<li><a href="#outface">outface</a>, set the network interface traffic is send via</li>
			<li><a href="#proto">proto</a>, match a specific protocol</li>
			<li><a href="#custom">custom</a>, pass a few custom parameters to the generated iptables
			statements</li>
			<li><a href="#log">log</a>, write something to the syslog when traffic is matched</li>
			<li><a href="#loglimit">loglimit</a>, write (limited) something to the syslog when traffic is matched</li>
			<li><a href="#with">with</a>, control the message send to the sender for packets REJECTed</li>
		</ul>
		&nbsp;
	</li>
	<li><a href="#control_variables">Variables that control FireHOL</a><br>&nbsp;</li>
	<li><a href="#use_variables">Variables FireHOL offers</a><br>&nbsp;</li>
</ul>

<hr noshade size=1 width="70%">

<center><a name="primary_commands"><h2>Primary commands</h2></a></center>

	<a name="interface"><h3><b>interface</b> <font color="red">&lt;real interface&gt;</font> <font color="red">&lt;name&gt;</font> <b>[optional rule parameters]</b></h3></a>
	<H4>Description</H4>
	The <b>interface</b> command creates a firewall for protecting the host the firewall is running, from the given interface.
	<br>The default interface policy is <b>drop</b>, so that if no subcommands are given, the
	firewall will just drop all incoming <b>and outgoing</b> traffic using this interface.
	<p>
	<H4>Parameters</H4>
	<ul>
		<li>	<b>real interface</b> is the interface name as shown by <b>ifconfig</b>.
			Generally anything iptables accepts, including the pattern character + (the plus sign), is valid.
			<br>The plus sign after some text will match all interfaces that start with this text.
			<br>It is allowed to use more than one interfaces separated by spaces, but all of them should be
			given within one quoted argument:
			<br>Example: <b>interface "eth0 eth1 ppp0" myname</b>
			<br>&nbsp;
			</li>

		<li>	<b>name</b> is a name for this interface.
			<br>Generally you should use short names (10 characters max) without spaces or other symbols.
			<br>You should not use the same name more than once in FireHOL primary commands.
			<br>&nbsp;
			</li>
			
		<li>	<b>optional rule parameters</b> is a set of rules that allow further restriction of the traffic that
			gets matched for this interface. See <a href="#parameters">Optional Rules Parameters</a> for more information.
			<br>Example 1: <b>interface eth0 intranet src 10.0.0.0/16</b>
			<br>Example 2: <b>interface eth0 internet src not "$UNROUTABLE_IPS"</b>
			(note: UNROUTABLE_IPS is a variable defined by FireHOL that includes all IPs that should not be routable
			by the Internet).
			<br>&nbsp;
			</li>
		</ul>
	<p>

<hr noshade size=1 width="70%">

	<a name="router"><h3><b>router</b> <font color="red">&lt;name&gt;</font> <b>[optional rule parameters]</b></h3></a>
	<H4>Description</H4>
	The <b>router</b> command creates a firewall for the traffic passing through the host running the firewall.
	The only acceptable policy on all <b>router</b> commands is <b>return</b> and therefore the policy subcommand
	cannot be used on routers. This means that no packets are dropped in a router. Packets not matched by any
	<b>router</b> command will be dropped at the end of the firewall.
	<p>
	<H4>Parameters</H4>
	<ul>
		<li>	<b>name</b> is a name for this router.
			<br>The same restrictions of <b>interface</b> names apply here too.
			<br>&nbsp;
			</li>
			
		<li>	<b>optional rule parameters</b> is a set of rules that allow further restriction of the traffic that
			gets matched for this router. See <a href="#parameters">Optional Rules Parameters</a> for more information.
			<br>&nbsp;
			</li>
		</ul>
	
	Router statements produce similar iptables commands the interface statements produce.
	For each router statement an <b>in_<font color="red">&lt;name&gt;</font></b> and an
	<b>out_<font color="red">&lt;name&gt;</font></b> chain are produced to match the traffic
	in both directions of the router.
	<br>
	To match some client or server traffic the administrator has to specify the input/output
	interface or the source/destination of the request.
	All inface/outface, src/dst optional rule parameters can be given either on the <b>router</b>
	statement in which case will be applied to all subcommands for this <i>router</i>,
	or on each subcommand within a <b>router</b>.
	Both are valid.
	<br>
	For example:
	<pre>
		router mylan inface ppp+ outface eth0
			server http accept
			client smtp accept
	</pre>
	The above says: Define a router that matches all <u>requests</u> that originate from some PPP interface and go out to eth0.<br>
	There is an HTTP server in eth0 that client from the PPP interfaces are allowed to reach.<br>
	Clients on eth0 are allowed to get SMTP traffic from the PPP interfaces.<br>
	<br>
	While:
	<pre>
		router mylan
			server http accept inface ppp+ outface eth0
			server smtp accept inface eth0 outface ppp+
	</pre>
	The above says: Define a router that matches any kind of forwarded traffic.<br>
	For HTTP traffic the clients are on a PPP interface and the servers on eth0.<br>
	For SMTP traffic the clients are on a eth0 interface and the servers o a PPP interface.
	<p>
	Please note that in the second example the SMTP traffic is matched again with a <b>server</b> subcommand,
	not a <b>client</b> (as in the first example).
	<p>
	The <b>client</b> subcommand <u>reverses</u> all the optional rules that are applied <u>indirectly</u> to it.
	Indirect rule parameters are those that are inherited from the parent command (<b>router</b> in this case).
	<br>
	To make it simple, for FireHOL a <b>client</b> is: "a <b>server</b> with all the implicit optional rule parameters reversed".
	<p>
	So, in the first example, the <b>client</b> simply flipped the inface and outface rules defined at the <b>router</b>
	and became an SMTP <b>server</b>.
	<br>In the second example there is nothing to be flipped, so <b>server</b> and <b>client</b>
	are exactly the same.<p>
	I suggest to use <b>client</b> subcommands in routers only if you have inface/outface or src/dst in the <b>router</b> statements.
	If you are building routers like the second example, don't use <b>client</b>, it is confusing.
	<p>
	Older versions of FireHOL did not allow server and client subcommands in routers.
	Only the <b>route</b> subcommand was allowed. Today, <b>route</b> is just an alias for <b>server</b> and can be
	used only in routers, not interfaces.
	<p>
	Any number of <b>router</b> statements can exist. Since the policy is RETURN on all of them, any traffic
	not matched by a <i>router</i> will continue to be checked against the second.
	<p>

<hr noshade size=1 width="70%">

	<a name="version"><h3><b>version</b> <font color="red">&lt;number&gt;</font></h3></a>
	<H4>Description</H4>
	The <b>version</b> command states the FireHOL <u>release</u> the configuration file was
	created for. In case the configuration file is newer than FireHOL, FireHOL will deny
	to run it.
	<p>
	This command is here to allow you or anyone else design and distribute FireHOL configuration files, while
	ensuring that the correct FireHOL version is going to run them.
	<p>
	Since FireHOL configurations are BASH script, it is relatively easy to use FireHOL configurations as small
	scripts that dynamically process rules stored in a database, in a file system as separate files, or elsewhere.
	This directive will help the developers of FireHOL configurations to control the required version of
	FireHOL.
	<p>
	The FireHOL release is increased every time the format of the configuration file and the internals of FireHOL are changed.
	<p>
	
<hr noshade size=1 width="70%">

	<a name="iptables"><h3><b>iptables</b> <font color="red">&lt;arguments&gt;</font></h3></a>
	<H4>Description</H4>
	The <b>iptables</b> command passes all its arguments to the real iptables command, during run-time.
	<p>
	You should not use in FireHOL configurations <b>/sbin/iptables</b> or other means to alter a FireHOL firewall.
	If you do, your commands will be run <u>before</u> FireHOL activates its firewall and while the <u>previous</u>
	firewall is still running. Also, since FireHOL will delete all <u>previous</u> firewall rules in order to
	activate the new firewall, any changes you will make, will be deleted too.
	<p>
	Always use the <b>iptables</b> directive to hook iptables commands in a FireHOL firewall. Nothing else.
	<p>

<hr noshade size=1 width="70%">
<center><a name="subcommands"><h2>Sub-Commands</h2></a></center>

	<a name="policy"><h3><b>policy</b> <font color="red">&lt;action&gt;</font></h3></a>
	<H4>Description</H4>
	The <b>policy</b> subcommand defines the default policy for an <b>interface</b>.
	<p>
	This directive accepts all the actions iptables accepts, i.e. DROP, REJECT, ACCEPT,
	RETURN, etc.
	Note that there is no meaning to use the LOG action, since FireHOL accepts it as an
	optional rule parameter (see bellow).
	<p>
	The policy of routers cannot be changed and is always RETURN.
	<p>

<hr noshade size=1 width="70%">

	<a name="protection"><h3><b>protection</b> [reverse] <font color="red">&lt;type&gt;</font> [requests/sec [burst]]</h3></a>
	<H4>Description</H4>
	The <b>protection</b> subcommand sets a number of protection rules on an <b>interface</b>.
	<p>
	In router configurations, <b>protections</b> are setup on <b>inface</b>. The <b>reverse</b> keyword will make the
	protections setup on <b>outface</b>.
	<p>
	<b>type</b> can be: <br>
	<ul><b>strong</b>, or <b>full</b>, or <b>all</b>
	<br>turns on all the possible protections.
	</ul>
	<ul><b>fragments</b>
	<br>Drops all packet fragments. Please note that most probably this rule will never match anything since
	iptables reconstructs all packets automatically, before the iptables firewall rules are processed, when its connection tracker is running.
	<br>I left this here for psychological reasons and in case some one finds some use for it.
	</ul>
	<ul><b>new-tcp-w/o-syn</b>
	<br>Drops all TCP packets that initiate a socket but have no the SYN bit set.
	</ul>
	<ul><b>syn-floods</b>
	<br>Allows only a certain amount of new TCP connections per second. The optional two arguments [requests/sec] and [burst]
	are used by this rule in order to provide control on the number of connections to be allowed.
	The default is 100 connections per second that can match 50 (it was 4 in v1.38 and before) packets initially
	(this is implemented using the <b>limit</b> module of iptables: see <b>man iptables</b> for more).
	<br>Note that this rule applies to all connections attempted regardless of their final result (rejected, dropped, established, etc).
	Therefore it might not be a good idea to set it too low.
	</ul>
	<ul><b>icmp-floods</b>
	<br>Allows only a certain amount of ICMP echo requests per second. The optional two arguments [requests/sec] and [burst]
	are used by this rule in order to provide control on the number of connections to be allowed.
	The default is 100 connections per second that can match 50 (it was 4 in v1.38 and before) packets initially
	(this is implemented using the <b>limit</b> module of iptables: see <b>man iptables</b> for more).
	</ul>
	<ul><b>malformed-xmas</b>
	<br>Drops all TCP packets that have all the TCP flags set.
	</ul>
	<ul><b>malformed-null</b>
	<br>Drops all TCP packets that have all the TCP flags unset.
	</ul>
	<ul><b>malformed-bad</b>
	<br>Drops all TCP packets that have illegal combinations of TCP flags set.
	</ul>
	<p>

<hr noshade size=1 width="70%">
	
	<a name="server"><h3><b>server</b> <font color="red">&lt;service&gt;</font> <font color="red">&lt;action&gt;</font> [optional rule parameters]</h3></a>
	<H4>Description</H4>
	The <b>server</b> subcommand defines a server of a service. For FireHOL a server is the destination of a request,
	and even if this is more complex for multi-socket services, <u>for FireHOL a server always accepts requests</u>.
	<br>This subcommand can be used on both interfaces and routers.
	<p>
	<H4>Parameters</H4>
	<ul>
		<li>	<b>service</b> is one of the supported service names.
			<br>The command accepts more than one services in the same argument if they are separated by space
			and quoted as a single argument.
			<br>Example 1: <b>server smtp accept</b>
			<br>Example 2: <b>server "smtp pop3 imap" accept</b>
			<br>&nbsp;
			</li>

		<li>	<b>action</b> tells FireHOL what to do with the traffic matching this rule.
			<p>FireHOL supports the following actions:
			<br><b>accept</b>, to allow the traffic reach its destination.
			<br><b>reject</b>, to reject this traffic by sending back an ICMP destination port unreachable message.
			The message this action sends back can be controlled using the optional rule parameter
			<a href="#with">with</a>.
			<br><b>drop</b>, to silently (for the sender) discard the traffic.
			<br>Please note that although FireHOL supports all other possible iptables actions, I suggest not to
			use them since FireHOL has not been tested with them.
			<br>Note also that the <b>log</b> iptables action is a FireHOL optional rule parameter and it is not
			required to be used as an action.
			<br>&nbsp;
			</li>
			
		<li>	<b>optional rule parameters</b> is a set of rules that allow further restriction of the traffic that
			gets matched by this rule. See <a href="#parameters">Optional Rules Parameters</a> for more information.
			<br>Example 1: <b>server smtp accept src 1.2.3.4</b>
			<br>Example 2: <b>server smtp accept log "its mail" src 1.2.3.4</b>
			<br>&nbsp;
			</li>
		</ul>
	<p>
	
<hr noshade size=1 width="70%">
	
	<a name="client"><h3><b>client</b> <font color="red">&lt;service&gt;</font> <font color="red">&lt;action&gt;</font> [optional rule parameters]</h3></a>
	The <b>client</b> subcommand defines a client of a service. For FireHOL a client is the source of a request.
	FireHOL follows this simple rule even on multi-socket complex protocols, so that <u>for FireHOL a client always sends requests</u>.
	<br>The parameters are exactly the same with the <b>server</b> subcommand.
	<br>This subcommand can be used on both interfaces and routers.
	<p>

<hr noshade size=1 width="70%">
	
	<a name="route"><h3><b>route</b> <font color="red">&lt;service&gt;</font> <font color="red">&lt;action&gt;</font> [optional rule parameters]</h3></a>
	The <b>route</b> subcommand is an alias for the <b>server</b> command. It can be used only on routers, not interfaces.
	<p>

<hr noshade size=1 width="70%">
	
	<a name="masquerade"><h3><b>masquerade</b> [reverse | interface] [optional rule parameters]</h3></a>
	The <b>masquerade</b> subcommand will setup masquerading on the outface of the parent primary command.
	<br>If reverse is specified it will masquerade on the input interface of the parent primary command.
	<br>If an interface is specified, masquerade will use this one.
	<p>
	This command can be used everywhere: within <a href="#interface">interfaces</a> and <a href="#router">routers</a> but also as primary command (in which case the interface argument is required).
	<p>
	Please note that if <b>masquerade</b> is used within some <a href="#interface">interface</a> or <a href="#router">router</a>, it does not respect the optional rule parameters
	given to this interface or router command. <b>Masquerade</b> uses <u>only</u> its own <a href="#parameters">optional rule parameters</a>.
	<p>

<hr noshade size=1 width="70%">
<a name="parameters"><center><h2>Optional Rule Parameters</h2></center></a>

	<a name="src"><h3><b>src</b> [not] <font color="red">&lt;host&gt;</font></h3></a>
	<H4>Description</H4>
	<b>src</b> defines the source IP address of the <u>REQUEST</u>. If <b>src</b> is defined on a <b>server</b> statement it matches the
	source of the request which is the remote host, while if it is defined on a <b>client</b> statement it matches <u>again</u>
	the source of the request, but this time it is the local host. <b>Focus on the REQUEST!!!</b> Forget the reply.
	<p>
	<H4>Parameters</H4>
	<ul>
		<li>	<b>not</b> is an optional argument that reverses the match. When defined, the rule will match all hosts
			except the ones defined.
			<br>Example: <b>server smtp accept src not 1.2.3.4</b>
			<br>&nbsp;
			</li>

		<li>	<b>host</b> can be an IP address, a hostname, or a subnet.
			<br>Multiple hosts/networks can be defined if separated by space and quoted as a single argument.
			<br>Example 1: <b>server smtp accept src 1.2.3.4</b>
			<br>Example 2: <b>server smtp accept src not "1.2.3.0/24 5.6.7.8 badhost.example.com"</b>
			<br>&nbsp;
			</li>
		</ul>
	<p>

<hr noshade size=1 width="70%">

	<a name="dst"><h3><b>dst</b> [not] <font color="red">&lt;host&gt;</font></h3></a>
	<H4>Description</H4>
	<b>dst</b> defines the destination of the <u>REQUEST</u>. If <b>dst</b> is defined on a <b>server</b> statement it matches the
	destination of the request which is the local host, while if it is defined on a <b>client</b> statement it matches <u>again</u>
	the destination of the request, but this time it is the remote host. <b>Focus on the REQUEST!!!</b> Forget the reply.
	<p>
	<b>dst</b> accepts the same parameters as <b>src</b>
	<p>
	
<hr noshade size=1 width="70%">

	<a name="inface"><h3><b>inface</b> [not] <font color="red">&lt;interface&gt;</font></h3></a>
	<H4>Description</H4>
	<b>inface</b> defines the interface the <u>REQUEST</u> is received via.
	<b>inface</b> cannot be used in <b>interface</b> commands.
	<p>
	<H4>Parameters</H4>
	<ul>
		<li>	<b>not</b> is an optional argument that reverses the match. When defined, the rule will match all interfaces
			except the ones defined.
			<br>Example: <b>server smtp accept inface not eth0</b>
			<br>&nbsp;
			</li>

		<li>	<b>interface</b> if an interface name in the same format the <b>interface</b> command accepts.
			<br>Multiple interfaces can be defined if separated by space and quoted as a single argument.
			<br>Example 1: <b>server smtp accept inface not eth0</b>
			<br>Example 2: <b>server smtp accept inface not "eth0 eth1"</b>
			<br>&nbsp;
			</li>
		</ul>
	<p>

<hr noshade size=1 width="70%">

	<a name="outface"><h3><b>outface</b> [not] <font color="red">&lt;interface&gt;</font></h3></a>
	<H4>Description</H4>
	<b>outface</b> defines the interface the <u>REQUEST</u> is send via.
	<b>outface</b> cannot be used in <b>interface</b> commands.
	<p>
	<b>outface</b> accepts the same parameters as <b>inface</b>.
	<p>

<hr noshade size=1 width="70%">

	<a name="proto"><h3><b>proto</b> [not] <font color="red">&lt;protocol&gt;</font></h3></a>
	<H4>Description</H4>
	<b>proto</b> sets the required protocol for the traffic. This command accepts anything iptables accepts as
	protocols.
	<p>

<hr noshade size=1 width="70%">

	<a name="custom"><h3><b>custom</b> "<font color="red">parameters</font>"</h3></a>
	<H4>Description</H4>
	<b>custom</b> passes its arguments to the generated iptables commands.
	<p>It is required to quote all the parameters given to <b>custom</b>. If the parameters include a space character
	between some text that is required to be given to iptables as one argument, it is required to escape another set of
	quotes in order. Another way is to use double quotes externally and single quotes internally.
	<br>
	<br>Example 1: <b>server smtp accept custom "--some-iptables-option and_its_value"</b>
	<br>Example 2: <b>server smtp accept custom "--some-iptables-option 'one_value another_value'"</b>
	<p>

<hr noshade size=1 width="70%">

	<a name="log"><h3><b>log</b> <font color="red">"&lt;some text&gt;"</font></h3></a>
	<H4>Description</H4>
	<b>log</b> will log the matching packets to syslog. Note that this is not an action (in iptables it is).
	FireHOL will actually produce multiple iptables commands to accomplish both the action for the rule and the logging.
	You can control how logging works, by altering the variable <a href="#FIREHOL_LOG_OPTIONS">FIREHOL_LOG_OPTIONS</a>.
	<p>
	FireHOL logs traffic, exactly the same way iptables does. Many users have complained about packet logs appearing at
	their console. To avoid this you will have to:
	<ul>
		<li>setup <b>klogd</b> to log only more important traffic</li>
		<li>change <a href="#FIREHOL_LOG_OPTIONS">FIREHOL_LOG_OPTIONS</a> to log at a not so important log-level</li>
	</ul>
	Actually <b>klogd</b>'s -c option and <b>iptables</b>' --log-level option are the same thing (iptables accepts also
	the numeric values klogd accepts). If iptables logs at a
	higher priority than klogd is configured to use, then your packets will appear in the console too.
	<p>
	In most kernels klogd is by default configured to log everything, so if you don't also change <b>klogd</b>'s -c option,
	the --log-level setting of iptables has no effect. Use the table bellow to match klogd options with --log-level options:
	
	<center>
	<table border=0 cellpadding=3 cellspacing=5 width="70%">
	<tr><th bgcolor="#000000"><font color="white">Priority</th><th bgcolor="#000000"><font color="white">klogd</th><th bgcolor="#000000"><font color="white">iptables</th><th bgcolor="#000000"><font color="white">Description</th></tr>
	<tr>	<td align="center"><b>0</td>
		<td align="center">0</td>
		<td align="center">emerg</td>
		<td>system is unusable</td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>1</td>
		<td align="center">1</td>
		<td align="center">alert</td>
		<td>action must be taken immediately</td>
		</tr>
	<tr>	<td align="center"><b>2</td>
		<td align="center">2</td>
		<td align="center">crit</td>
		<td>critical conditions</td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>3</td>
		<td align="center">3</td>
		<td align="center">error</td>
		<td>error conditions</td>
		</tr>
	<tr>	<td align="center"><b>4</td>
		<td align="center">4</td>
		<td align="center">warning (default)</td>
		<td>warning conditions</td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>5</td>
		<td align="center">5</td>
		<td align="center">notice</td>
		<td>normal but significant condition</td>
		</tr>
	<tr>	<td align="center"><b>6</td>
		<td align="center">6</td>
		<td align="center">info</td>
		<td>informational</td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>7</td>
		<td align="center">7 (default)</td>
		<td align="center">debug</td>
		<td>debug-level messages</td>
		</tr>
	</table>
	</center><p>
	To prevent packet logs appearing to the console, <b>klogd</b> option must be LOWER than the one iptables uses.
	<p>
	On <a href="http://www.redhat.com">RedHat</a> systems, you can configure <b>klogd</b> by changing
	<b>/etc/sysconfig/syslog</b> and adding to <b>KLOGD_OPTIONS</b> the required -c level.
	<p>
	
<hr noshade size=1 width="70%">

	<a name="loglimit"><h3><b>loglimit</b> <font color="red">"&lt;some text&gt;"</font></h3></a>
	<H4>Description</H4>
	<b>loglimit</b> is the same with <b>log</b> but limits the frequency of logging according to the setting of
	<a href="#FIREHOL_LOG_FREQUENCY">FIREHOL_LOG_FREQUENCY</a> and <a href="#FIREHOL_LOG_BURST">FIREHOL_LOG_BURST</a>.
	<p>

<hr noshade size=1 width="70%">

	<a name="with"><h3><b>with</b> <font color="red">"&lt;message&gt;"</font></h3></a>
	<H4>Description</H4>
	<b>with</b> is used on action "REJECT" to offer control on the message to be returned to the sender. Using <b>with</b>
	with any action, other than REJECT, will produce an error.<p>
	<b>with</b> accepts all the arguments the <b>--reject-with</b> iptables expression accepts. For an updated list
	of these messages type <b>iptables -j REJECT --help</b>. Bellow you can find the list my system accepts:
	<p>
	<center>
	<table border=0 cellpadding=3 cellspacing=5 width="70%">
	<tr><th bgcolor="#000000"><font color="white">Message</th><th bgcolor="#000000"><font color="white">Alias</th><th bgcolor="#000000"><font color="white">Description</th><th bgcolor="#000000"><font color="white">Reference</th></tr>
	<tr>	<td align="center"><b>icmp-net-unreachable</td>
		<td align="center"><b>net-unreach</td>
		<td><b>ICMP network unreachable</b>
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		Generated by a router if a forwarding path (route) to the destination network is not available.
		<p><small><b><font color="gray">Notes</font></b></small><br>
		Use this with care. The sender and the routers between you and the sender may conclude that
		the whole network your host resides in, is unreachable and prevent other traffic from
		reaching you.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc0792.txt?number=792">RFC 792</a></td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>icmp-host-unreachable</td>
		<td align="center"><b>host-unreach</td>
		<td><b>ICMP host unreachable</b>
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		Generated by a router if a forwarding path (route) to the destination host on a directly connected network
		is not available (does not respond to ARP).
		<p><small><b><font color="gray">Notes</font></b></small><br>
		Use this with care. The sender and the routers between you and the sender may conclude that
		your server is unreachable and prevent the transmission of other traffic to you.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc0792.txt?number=792">RFC 792</a></td>
		</tr>
	<tr>	<td align="center"><b>icmp-proto-unreachable</td>
		<td align="center"><b>proto-unreach</td>
		<td><b>ICMP protocol unreachable</b>
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		Generated if the transport protocol designated in a datagram is not supported in the transport layer
		of the final destination.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc0792.txt?number=792">RFC 792</a></td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>icmp-port-unreachable</td>
		<td align="center"><b>port-unreach</td>
		<td><b>ICMP port unreachable</b> (default)
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		Generated if the designated transport protocol (e.g. TCP, UDP, etc) is unable to demultiplex the
		datagram in the transport layer of the final destination but has no protocol mechanism to inform
		the sender.
		<p><small><b><font color="gray">In other words</font></b></small><br>
		Generated by hosts to indicate that the required port is not active.</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc0792.txt?number=792">RFC 792</a></td>
		</tr>
	<tr>	<td align="center"><b>icmp-net-prohibited</td>
		<td align="center"><b>net-prohib</td>
		<td><b>ICMP communication with destination network administratively prohibited</b>
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		This code was intended for use by end-to-end encryption devices used by U.S military agencies.
		Routers SHOULD use the newly defined Code 13 (Communication Administratively Prohibited) if they
		administratively filter packets.
		<p><small><b><font color="gray">In other words</font></b></small><br>
		Use it, but don't expect that this will be widely understood.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc1122.txt?number=1122">RFC 1122</a></td>
		</tr>
	<tr bgcolor="#F0F0F0">	<td align="center"><b>icmp-host-prohibited</td>
		<td align="center"><b>host-prohib</td>
		<td><b>ICMP communication with destination host administratively prohibited</b>
		<p><small><b><font color="gray">From RFC 1812 section 5.2.7.1</font></b></small><br>
		This code was intended for use by end-to-end encryption devices used by U.S military agencies.
		Routers SHOULD use the newly defined Code 13 (Communication Administratively Prohibited) if they
		administratively filter packets.
		<p><small><b><font color="gray">In other words</font></b></small><br>
		Use it, but don't expect that this will be widely understood.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1812.txt?number=1812">RFC 1812</a>
		<a href="http://www.ietf.org/rfc/rfc1122.txt?number=1122">RFC 1122</a></td>
		</tr>
	<tr>	<td align="center"><b>tcp-reset</td>
		<td align="center"><b>tcp-reset</td>
		<td><b>TCP RST</b>
		<p>
		This is the port unreachable message of the TCP stack. It is useful when you want to prevent
		timeouts on rejected TCP services when the client is badly written to ignore ICMP port unreachable
		messages.
		<p>
		I suggest to use this for rejecting idents:<br><b>server ident reject with tcp-reset</b>.
		</td>
		<td align="center"><a href="http://www.ietf.org/rfc/rfc1122.txt?number=1122">RFC 1122</a></td>
		</tr>
	</table>
	</center>
	<br>
	<br>Example 1: <b>policy reject with host-unreach</b>
	<br>Example 2: <b>server ident reject with tcp-reset</b>
	<br>Example 3: <b>UNMATCHED_INPUT_POLICY="reject with host-prohib"</b>
	<p>

<hr noshade size=1 width="70%">
<a name="control_variables"><center><h2>Variables that control FireHOL</h2></center></a>

	<a name="DEFAULT_INTERFACE_POLICY"><h3><b>DEFAULT_INTERFACE_POLICY</b></h3></a>
	<H4>Description</H4>
	DEFAULT_INTERFACE_POLICY controls the default action to be taken on traffic not matched by any rule within an interface.
	The value of DEFAULT_INTERFACE_POLICY is passed as is to iptables, so use capitals. Be careful not to accept the traffic
	not matched by any rule, as it will break your firewall. It is however safe enough to use RETURN here (but see bellow
	to find out what happens at the end of your firewall).
	<p>
	All packets that reach the end of an interface are logged only if the action is not RETURN or ACCEPT.
	You can control the frequency of this logging by altering the frequency <a href="#loglimit">loglimit</a> uses.
	<p>
	Default: <b>DEFAULT_INTERFACE_POLICY="DROP"</b><br>
	<br>
	Example: <b>DEFAULT_INTERFACE_POLICY="REJECT"</b>
	<p>

<hr noshade size=1 width="70%">

	<a name="UNMATCHED_INPUT_POLICY"><h3><b>UNMATCHED_INPUT_POLICY</b></h3></a>
	<a name="UNMATCHED_OUTPUT_POLICY"><h3><b>UNMATCHED_OUTPUT_POLICY</b></h3></a>
	<a name="UNMATCHED_FORWARD_POLICY"><h3><b>UNMATCHED_FORWARD_POLICY</b></h3></a>
	<H4>Description</H4>
	UNMATCHED_INPUT_POLICY controls the default action to be taken for incoming traffic not matched by any interface command.
	<br>UNMATCHED_OUTPUT_POLICY controls the default action to be taken for outgoing traffic not matched by any interface command.
	<br>UNMATCHED_FORWARD_POLICY controls the default action to be taken for forwarded traffic not matched by any router command.
	<p>
	All packets that reach the end of firewall in all three chains are logged (always, regardless of these settings).
	You can control the frequency of this logging by altering the frequency <a href="#loglimit">loglimit</a> uses.
	<p>
	Default: <b>DEFAULT_INPUT_POLICY="DROP"</b><br>
	Default: <b>DEFAULT_OUTPUT_POLICY="DROP"</b><br>
	Default: <b>DEFAULT_FORWARD_POLICY="DROP"</b><br>
	<br>
	Example: <b>DEFAULT_INPUT_POLICY="REJECT"</b><br>
	Example: <b>DEFAULT_OUTPUT_POLICY="REJECT"</b><br>
	Example: <b>DEFAULT_FORWARD_POLICY="REJECT"</b>
	<p>
	
<hr noshade size=1 width="70%">

	<a name="FIREHOL_LOG_OPTIONS"><h3><b>FIREHOL_LOG_OPTIONS</b></h3></a>
	<a name="FIREHOL_LOG_FREQUENCY"><h3><b>FIREHOL_LOG_FREQUENCY</b></h3></a>
	<a name="FIREHOL_LOG_BURST"><h3><b>FIREHOL_LOG_BURST</b></h3></a>
	<H4>Description</H4>
	FIREHOL_LOG_OPTIONS controls way iptables will log things to the syslog.
	The value of this variable is passed as is to iptables, so use exact iptables parameters.
	<p>
	FIREHOL_LOG_FREQUENCY and FIREHOL_LOG_BURST (added in v1.39 of FireHOL) control the frequency at each each logging
	rule will write packets to the syslog. FIREHOL_LOG_FREQUENCY is set to the maximum average
	frequency and FIREHOL_LOG_BURST specifies the maximum initial number of packets to match.
	<p>
	Default: <b>FIREHOL_LOG_OPTIONS="--log-level warning"</b><br>
	Default: <b>FIREHOL_LOG_FREQUENCY="1/second"</b><br>
	Default: <b>FIREHOL_LOG_BURST="5"</b><br>
	<br>
	Example: <b>FIREHOL_LOG_OPTIONS="--log-level info --log-tcp-options --log-ip-options"</b><br>
	Example: <b>FIREHOL_LOG_FREQUENCY="30/minute"</b><br>
	Example: <b>FIREHOL_LOG_BURST="2"</b><br>
	<br>
	To see the available iptables log options, run <b>/sbin/iptables -j LOG --help</b><br>
	To see what iptables accepts as frequencies and bursts run, <b>/sbin/iptables -m limit --help</b></br>
	You can also check <b>man iptables</b>.
	<p>
	
<hr noshade size=1 width="70%">

	<a name="DEFAULT_CLIENT_PORTS"><h3><b>DEFAULT_CLIENT_PORTS</b></h3></a>
	<H4>Description</H4>
	DEFAULT_CLIENT_PORTS controls the port range to be used when a remote client is specified.
	For localhost clients, FireHOL finds the exact client ports by querying the kernel options.
	<p>
	Default: <b>1000:65535</b>
	<br>
	Example: <b>DEFAULT_CLIENT_PORTS="0:65535"</b>
	<p>

<hr noshade size=1 width="70%">

	<a name="FIREHOL_NAT"><h3><b>FIREHOL_NAT</b></h3></a>
	<H4>Description</H4>
	If FIREHOL_NAT is set to 1, FireHOL will load NAT kernel modules for those services that they required.
	<p>
	Default: <b>0</b>
	<br>
	Example: <b>FIREHOL_NAT="1"</b>
	<p>


<hr noshade size=1 width="70%">
<a name="use_variables"><center><h2>Variables that FireHOL offers</h2></center></a>

	<a name="RESERVED_IPS"><h3><b>RESERVED_IPS</b></h3></a>
	<H4>Description</H4>
	This variable includes all the IP addresses defined as <b>IANA - Reserved</b> by <a href="http://www.iana.org">IANA</a>.
	The supplied <b>get-iana.sh</b> script creates this variable by directly fetching <a href="http://www.iana.org/assignments/ipv4-address-space">this</a> document.
	<p>
	Example: <b>interface eth0 internet src not "${RESERVED_IPS}"</b>
	<p>
	
<hr noshade size=1 width="70%">

	<a name="PRIVATE_IPS"><h3><b>PRIVATE_IPS</b></h3></a>
	<H4>Description</H4>
	This variable includes all the IP addresses defined as <b>Private</b> or <b>Test</b> by <a href="http://www.ietf.org/rfc/rfc3330.txt?number=3330">RFC 3330</a>.
	<p>
	Example: <b>interface eth0 internet src not "${PRIVATE_IPS}"</b>
	<p>
	
<hr noshade size=1 width="70%">

	<a name="UNROUTABLE_IPS"><h3><b>UNROUTABLE_IPS</b></h3></a>
	<H4>Description</H4>
	This variable is both RESERVED_IPS and PRIVATE_IPS together. I suggest to use this variable on interfaces and routers
	accepting Internet traffic.
	<p>
	Example: <b>interface eth0 internet src not "${UNROUTABLE_IPS}"</b>
	<p>
	

<p>
<hr noshade size=1>
<table border=0 width="100%">
<tr><td align=center valign=middle>
	<A href="http://sourceforge.net"><IMG src="http://sourceforge.net/sflogo.php?group_id=58425&amp;type=5" width="210" height="62" border="0" alt="SourceForge Logo"></A>
</td><td align=center valign=middle>
	<small>$Id: commands.html,v 1.9 2002/12/31 11:57:40 ktsaou Exp $</small>
	<p>
	<b>FireHOL</b>, a firewall for humans...<br>
	&copy; Copyright 2002
	Costa Tsaousis <a href="mailto: costa@tsaousis.gr">&lt;costa@tsaousis.gr&gt</a>
</body>
</html>
