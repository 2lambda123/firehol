#
# Test demonstrating ability to use DNS names when activation policy set
# to accept.
#
version 5

. ${REGRESSDIR}include/regression.conf

# N.B. These are the FireHOL defaults
FIREHOL_INPUT_ACTIVATION_POLICY="ACCEPT"
FIREHOL_OUTPUT_ACTIVATION_POLICY="ACCEPT"
FIREHOL_FORWARD_ACTIVATION_POLICY="ACCEPT"
FIREHOL_ESTABLISHED_ACTIVATION_ACCEPT="0"

if [ "$FIREHOL_OUTPUT_ACTIVATION_POLICY" = "ACCEPT" ]; then
# This interface is set up to allow DNS lookups in e.g. fast activation
# mode, when IPv4 rules will all come into place with their final policy
# before IPv6 is processed
interface any myany
	policy deny
	client dns accept
fi

interface eth0 myeth0
	policy deny
	ipv4 client http accept dst ctest-ipv4.firehol.org
if ipv6_capable; then
	ipv6 client http accept dst ctest-ipv6.firehol.org
fi

interface eth1 myeth1
	policy deny

router e0toe1 inface eth0 outface eth1
	policy deny

router e1toe0 inface eth1 outface eth0
	policy deny
